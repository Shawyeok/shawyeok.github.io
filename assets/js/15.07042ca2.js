(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{308:function(t,e,a){t.exports=a.p+"assets/img/f50d5939070a4ac8b65cfed50c57a159.a0d0d4f1.png"},309:function(t,e,a){t.exports=a.p+"assets/img/63b42cd0d3a94f048b1841d5375e2eb8.763d3831.png"},310:function(t,e,a){t.exports=a.p+"assets/img/ae71374fa6a442989b14d5d517f5e4cf.c83d2d3f.png"},311:function(t,e,a){t.exports=a.p+"assets/img/37b4d8edf3074849a96df5bfee4a3222.3d428654.png"},312:function(t,e,a){t.exports=a.p+"assets/img/7b32426823774577aa1d8e9b079fe43c.62310fca.png"},313:function(t,e,a){t.exports=a.p+"assets/img/2c019ae755fb42e6bdbe0c7ae6b55df1.866452b6.png"},314:function(t,e,a){t.exports=a.p+"assets/img/ac9fb5b6f9ef4236bcb1af227a6ab48c.2858a6c7.png"},337:function(t,e,a){"use strict";a.r(e);var s=a(10),r=Object(s.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"为什么我的域名ping不通"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#为什么我的域名ping不通"}},[t._v("#")]),t._v(" 为什么我的域名ping不通？")]),t._v(" "),e("blockquote",[e("p",[t._v("本文主要是复现 https://articles.zsxq.com/id_xjarfxn53dz9.html 的case并进行排查。")])]),t._v(" "),e("p",[t._v("首先按照实验准备复制博主的hosts两行配置，成功复现问题，第一个域名ping不通，第二个可以：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("127.0.0.1　 test.unknow.host\n127.0.0.1   test.localhost\n")])])]),e("p",[e("img",{attrs:{src:a(308),alt:"alt text"}})]),t._v(" "),e("p",[t._v("其实这个问题在上面复现过程中问题原因我大概已经猜到了，在上面通过vim编辑hosts文件追加上面两行配置就可见一些蹊跷：\n"),e("img",{attrs:{src:a(309),alt:"alt text"}})]),t._v(" "),e("p",[t._v("博主设计了一些特殊的不可见字符（看起来像是空格）在里面，对于这种情况，可以用"),e("code",[t._v("xxd")]),t._v("直接查看文本内容的字节表示\n"),e("img",{attrs:{src:a(310),alt:"alt text"}})]),t._v(" "),e("p",[t._v("然后再分别看一下"),e("code",[t._v("0xE3")]),t._v("和"),e("code",[t._v("0x80")]),t._v("都是些什么字符？\n"),e("img",{attrs:{src:a(311),alt:"alt text"}})]),t._v(" "),e("p",[t._v("当然上面是条件反射式，更通用和普适的方法可以用"),e("a",{attrs:{href:"https://man7.org/linux/man-pages/man1/strace.1.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("strace(1)"),e("OutboundLink")],1)]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("strace -e trace=%file,read -s 1024 ping test.unknow.host\n")])])]),e("p",[t._v("这时候你去对一下ping命令实际去读hosts文件的read syscall就可见端倪\n"),e("img",{attrs:{src:a(312),alt:"alt text"}})]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("strace -e trace=%network -s 1024 ping test.unknow.host\n")])])]),e("p",[t._v("既然本地hosts配置没有生效，ping就会向本地dns发起请求，如下"),e("code",[t._v("127.0.0.11")]),t._v("就是笔者测试环境的dns（docker容器环境）\n"),e("img",{attrs:{src:a(313),alt:"alt text"}})]),t._v(" "),e("p",[t._v("另外一边用tcpdump抓包\n"),e("img",{attrs:{src:a(314),alt:"alt text"}})]),t._v(" "),e("p",[t._v("这里有个关键字"),e("code",[t._v("NXDomain")]),t._v("，这时候就可以Google了")]),t._v(" "),e("blockquote",[e("p",[t._v("The DNS protocol "),e("a",{attrs:{href:"https://datatracker.ietf.org/doc/html/rfc1035",target:"_blank",rel:"noopener noreferrer"}},[t._v("RFC1035"),e("OutboundLink")],1),t._v(' defines response code 3 as "Name Error",'),e("br"),t._v('\nor "NXDOMAIN" '),e("a",{attrs:{href:"https://datatracker.ietf.org/doc/html/rfc2308",target:"_blank",rel:"noopener noreferrer"}},[t._v("RFC2308"),e("OutboundLink")],1),t._v(", which means that the queried domain name"),e("br"),t._v("\ndoes not exist in the DNS.")])]),t._v(" "),e("ul",[e("li",[t._v("So "),e("code",[t._v("NXDomain")]),t._v(" stands for "),e("code",[t._v("not exist domain")]),t._v("?")])]),t._v(" "),e("h3",{attrs:{id:"参考"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[t._v("#")]),t._v(" 参考")]),t._v(" "),e("ul",[e("li",[t._v("https://datatracker.ietf.org/doc/html/rfc8020#section-1")]),t._v(" "),e("li",[t._v("https://bytetool.web.app/en/ascii/")])])])}),[],!1,null,null,null);e.default=r.exports}}]);